'use strict';
(function initAppGlobals() {
    const meta = document.querySelector('meta[name="csrf-token"]');
    const token = meta ? meta.getAttribute('content') || '' : '';
    window.App = window.App || {};
    window.App.csrfToken = token;
    window.csrfToken = token;

    function normalizeNumber(value) {
        if (typeof value === 'number' && Number.isFinite(value)) {
            return value
        }
        const parsed = Number(value);
        return Number.isFinite(parsed) ? parsed : 0
    }

    function formatInt(value) {
        const n = normalizeNumber(value);
        try {
            return n.toLocaleString('en-US')
        } catch (err) {
            return String(n)
        }
    }

    function formatNumber(value, minimumFractionDigits, maximumFractionDigits) {
        const n = normalizeNumber(value);
        const min = typeof minimumFractionDigits === 'number' ? minimumFractionDigits : 0;
        const max = typeof maximumFractionDigits === 'number' ? maximumFractionDigits : minimumFractionDigits !== undefined ? minimumFractionDigits : 2;
        try {
            return n.toLocaleString('en-US', {
                minimumFractionDigits: min,
                maximumFractionDigits: max,
            })
        } catch (err) {
            return String(n.toFixed(Math.max(0, Math.min(20, max))))
        }
    }
    window.App.formatInt = formatInt;
    window.App.formatNumber = formatNumber;
    if (typeof window.formatInt !== 'function') {
        window.formatInt = formatInt
    }
})()